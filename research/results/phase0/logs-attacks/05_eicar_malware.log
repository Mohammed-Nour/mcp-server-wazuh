===============================================================================
[1;33mATTACK #05: EICAR Test File Download[0m
===============================================================================
Target: ec2-54-204-182-4.compute-1.amazonaws.com
Category: Malware

The EICAR test file is a safe, industry-standard test file
used to verify antivirus/malware detection capabilities.

[0;32m[*] Attack started at: 2026-01-05T18:52:17+03:00[0m

[*] Commands to run on target agent:


#!/bin/bash
echo "[*] EICAR test file malware simulation..."

# EICAR test string - this is a SAFE test file, not actual malware
# Standard EICAR test string
EICAR_STRING="X5O!P%@AP[4\PZX54(P^)7CC)7}\$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!\$H+H*"

# Method 1: Create EICAR file directly
echo "[*] Creating EICAR test file in /tmp..."
echo "$EICAR_STRING" > /tmp/eicar.com
echo "$EICAR_STRING" > /tmp/eicar.txt
echo "$EICAR_STRING" > /tmp/malware_test.exe

# Method 2: Download from official source
echo "[*] Downloading EICAR test files..."
cd /tmp

# Try multiple EICAR sources
curl -s -o eicar_download.com "https://www.eicar.org/download/eicar.com" 2>/dev/null || \
wget -q -O eicar_download.com "https://www.eicar.org/download/eicar.com" 2>/dev/null || \
echo "    Could not download from eicar.org"

curl -s -o eicar_download.txt "https://www.eicar.org/download/eicar.com.txt" 2>/dev/null || \
wget -q -O eicar_download.txt "https://www.eicar.org/download/eicar.com.txt" 2>/dev/null || \
echo "    Could not download txt version"

# Method 3: Create in web directory if exists
if [ -d "/var/www/html" ]; then
    echo "[*] Creating EICAR in web directory..."
    echo "$EICAR_STRING" | sudo tee /var/www/html/eicar.com > /dev/null 2>&1
fi

# Method 4: Create with suspicious names
echo "[*] Creating files with suspicious names..."
echo "$EICAR_STRING" > /tmp/trojan.exe
echo "$EICAR_STRING" > /tmp/virus.bat
echo "$EICAR_STRING" > /tmp/ransomware.dll

# List created files
echo ""
echo "[*] Test files created:"
ls -la /tmp/eicar* /tmp/trojan* /tmp/virus* /tmp/ransomware* /tmp/malware* 2>/dev/null

echo ""
echo "[*] Waiting for detection..."
sleep 10

# Cleanup
echo "[*] Cleaning up test files..."
rm -f /tmp/eicar* /tmp/trojan* /tmp/virus* /tmp/ransomware* /tmp/malware* 2>/dev/null
sudo rm -f /var/www/html/eicar.com 2>/dev/null

echo "[*] Cleanup complete"

[*] Running attack via SSH using key /home/mohamad/.ssh/wazuh-agnet.pem ...
[*] EICAR test file malware simulation...
[*] Creating EICAR test file in /tmp...
[*] Downloading EICAR test files...
[*] Creating EICAR in web directory...
[*] Creating files with suspicious names...

[*] Test files created:
-rw-rw-r-- 1 ubuntu ubuntu   69 Jan  5 15:52 /tmp/eicar.com
-rw-rw-r-- 1 ubuntu ubuntu   69 Jan  5 15:52 /tmp/eicar.txt
-rw-rw-r-- 1 ubuntu ubuntu 2516 Jan  5 15:52 /tmp/eicar_download.com
-rw-rw-r-- 1 ubuntu ubuntu   68 Jan  5 15:52 /tmp/eicar_download.txt
-rw-rw-r-- 1 ubuntu ubuntu   69 Jan  5 15:52 /tmp/malware_test.exe
-rw-rw-r-- 1 ubuntu ubuntu   69 Jan  5 15:52 /tmp/ransomware.dll
-rw-rw-r-- 1 ubuntu ubuntu   69 Jan  5 15:52 /tmp/trojan.exe
-rw-rw-r-- 1 ubuntu ubuntu   69 Jan  5 15:52 /tmp/virus.bat

[*] Waiting for detection...
[*] Cleaning up test files...
[*] Cleanup complete

===============================================================================
[0;32m[âœ“] Attack script generated[0m
===============================================================================
Start Time: 2026-01-05T18:52:17+03:00
End Time: 2026-01-05T18:52:38+03:00

Expected Wazuh alerts:
  - Rule 510: Malware detected
  - Rule 87105: ClamAV detection (if ClamAV is installed)
  - Rule 87106: Malware scan detection
  - Syscheck alerts for suspicious file creation

Note: EICAR test file is completely SAFE and is industry standard
for testing antivirus/malware detection systems.

Data for CSV:
  attack_id: 05
  attack_name: EICAR Test File Download
  category: Malware
  attack_start_time: 2026-01-05T18:52:17+03:00
  attack_end_time: 2026-01-05T18:52:38+03:00
